
<odoo>
  <menuitem id="menu_eudr_ai_root" name="Planetio" groups="base.group_user" web_icon="planetio,static/description/icon.png"/>

  <record id="action_eudr_declaration" model="ir.actions.act_window">
    <field name="name">EUDR Declarations</field>
    <field name="res_model">eudr.declaration</field>
    <field name="view_mode">tree,form</field>
  </record>

  <record id="action_eudr_stage" model="ir.actions.act_window">
    <field name="name">EUDR Stages</field>
    <field name="res_model">eudr.stage</field>
    <field name="view_mode">tree,form</field>
  </record>

 <menuitem id="menu_eudr_declarations" name="Declarations"
            parent="menu_eudr_ai_root" action="action_eudr_declaration"/>

    <record id="view_eudr_declaration_tree" model="ir.ui.view">
      <field name="name">eudr.declaration.tree</field>
      <field name="model">eudr.declaration</field>
      <field name="arch" type="xml">
        <tree>
          <field name="name"/>
          <field name="create_date"/>
          <field name="source_attachment_id"/>
          <field name="area_ha"/>
          <field name="geo_type"/>
        </tree>
      </field>
    </record>

  <menuitem id="menu_eudr_stage_root" name="Stage" parent="menu_eudr_ai_root" action="action_eudr_stage"/>

<record id="view_eudr_declaration_form" model="ir.ui.view">
  <field name="name">eudr.declaration.form</field>
  <field name="model">eudr.declaration</field>
  <field name="arch" type="xml">
    <form string="EUDR Declaration">
      <header>
          <button name="action_open_import_wizard" type="object"
                  string="Import Wizard" class="btn-secondary" icon="fa-upload"/>
<!--          <button name="action_export_geojson" type="object"-->
<!--                  string="Export GeoJSON" class="oe_highlight" icon="fa-download"/>-->
          <button name="action_analyze_deforestation" type="object" class="oe_highlight btn-success"
                  string="Deforestation analysis" icon="fa-tree"/>
          <button name="action_transmit_dds" type="object" class="oe_highlight"
                  string="Trasmit DDS" icon="fa-paper-plane"/>
          <field name="stage_id" widget="statusbar" options="{'clickable': '1'}"/>
      </header>

      <sheet>
        <div class="oe_title">
          <h1><field name="name" placeholder="Eudr sequence"/></h1>
        </div>

        <group>
            <group>
              <field name="datestamp" string="Creation date"/>
              <field name="partner_id"/>
              <field name="eudr_company_type" readonly="0"/>
              <field name="eudr_type_override"/>
              <field name="eudr_third_party_client_id" attrs="{'invisible': [('eudr_company_type','!=','third_party_trader')]}"/>
              <field name="source_attachment_id" readonly="1" invisible="1"/>
              <field name="hs_code"/>
            </group>
            <group>
              <field name="activity_type"/>
              <field name="area_ha" readonly="1"/>
              <field name="product_id" invisible="1"/>
              <field name="coffee_species" invisible="0"/>
              <field name="net_mass_kg" invisible="0"/>
              <field name="operator_name" invisible="0"/>
              <field name="hs_code" invisible="1"/>
              <field name="product_description" invisible="1"/>
              <field name="name" string="Internal Ref"/>
              <field name="eudr_id" string="EUDR Ref"/>
            </group>
        </group>

        <notebook>
          <page string="Details">
            <field name="line_ids">
              <tree string="Dettagli"
                    decoration-success="external_ok"
                    decoration-danger="not external_ok"
                    editable="top">
                <field name="external_ok" widget="boolean_toggle" readonly="0" string=""/>
                <field name="external_message" invisible="1"/>
                <field name="name" attrs="{'invisible': [('name', '=', False)]}"/>
                <field name="farmer_id_code" attrs="{'invisible': [('farmer_id_code', '=', False)]}"/>
                <field name="farmer_name" attrs="{'invisible': [('farmer_name', '=', False)]}"/>
                <field name="farm_name" attrs="{'invisible': [('farm_name', '=', False)]}"/>
                <field name="country"/>
                <field name="region"/>
                <field name="municipality" attrs="{'invisible': [('municipality', '=', False)]}"/>
                <field name="area_ha" invisible="0"/>
                <field name="external_status" invisible="1"/>
                <field name="external_message_short" string="Message" invisible="1"/>
                <field name="geometry" invisible="0"/>
              </tree>
              <form>
                <header>
                  <button name="action_visualize_point_on_map" type="object" class="oe_highlight"
                  string="Show point on map" icon="fa-globe"/>
                  <button name="action_visualize_area_on_map" type="object" class="oe_highlight"
                  string="Show area on map" icon="fa-globe" help="Se presente un solo punto viene ipotizzata un'area di 50mq intorno allo stesso"/>
                </header>
                  <group>
                    <group string="Farm data">
                      <field name="name"/>
                      <field name="farmer_name"/>
                      <field name="farmer_id_code"/>
                      <field name="tax_code"/>
                      <field name="country"/>
                      <field name="region"/>
                      <field name="municipality"/>
                      <field name="farm_name"/>
                    </group>
                    <group string="Geo data">
                      <field name="area_ha"/>
                      <field name="geo_type"/>
                      <field name="geo_type_raw"/>
<!--                      <field name="defor_detail_json"/>-->
                      <field name="geometry" widget="text" invisible="0"/>
                    </group>
                    <group string="Additional api data">
                      <field name="external_ok" widget="boolean_toggle" readonly="1"/>
                      <field name="external_status"/>
                      <field name="external_http_code"/>
                      <field name="external_uid"/>
                      <field name="external_message" widget="text" string="External Message (full)"/>
                      <field name="external_properties_json" widget="text"/>
                    </group>
                  </group>
              </form>
            </field>
          </page>
          <page string="Documents">
            <field name="attachment_ids"
                   context="{
                     'default_res_model': 'eudr.declaration',
                     'default_res_id': active_id,
                     'bin_size': False
                   }"
                   domain="[('res_model', '=', 'eudr.declaration')]">
              <tree editable="bottom" string="Attachments">
                <field name="name" required="1"/>
                <field name="type"/>
                <field name="url" attrs="{'invisible': [('type','!=','url')]}"/>
                <field name="create_date" readonly="1"/>
              </tree>
              <form string="Attachment">
                <sheet>
                  <group>
                    <field name="name"/>
                    <field name="type"/>
                    <field name="url" attrs="{'invisible': [('type','!=','url')]}"/>
                  </group>
                  <group>
                    <field name="mimetype" readonly="1"/>
                    <field name="description"/>
                    <field name="res_model" invisible="1"/>
                    <field name="res_id" invisible="1"/>
                  </group>
                </sheet>
              </form>
            </field>
          </page>
        </notebook>

        <!-- “footer” notes area at bottom of sheet -->
          <group string="Additional info" col="1">
            <field name="extra_info" widget="text"/>
          </group>
      </sheet>

      <div class="oe_chatter">
        <field name="message_follower_ids" widget="mail_followers"/>
        <field name="message_ids" widget="mail_thread"/>
      </div>
    </form>
  </field>
</record>

</odoo>
